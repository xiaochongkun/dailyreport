# Phase III æµ‹è¯•ç¯å¢ƒé…ç½®å®Œæˆ

## âœ… å·²å®Œæˆçš„ä»»åŠ¡

### 1. æµ‹è¯•ç›®å½•ç»“æ„åˆ›å»ºå®Œæˆ

```
/home/kunkka/projects/dailyreport/tests/
â”œâ”€â”€ README_TEST.md           # è¯¦ç»†ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ raw_messages/            # å­˜æ”¾åŸå§‹æ¶ˆæ¯JSON
â”œâ”€â”€ reports_preview/         # æ—¥æŠ¥é¢„è§ˆHTMLï¼ˆå¾…ç”Ÿæˆï¼‰
â””â”€â”€ alerts_preview/          # é¢„è­¦æ¨¡æ¿é¢„è§ˆï¼ˆå¾…ç”Ÿæˆï¼‰
```

### 2. æµ‹è¯•æ•°æ®å¯¼å‡ºè„šæœ¬å·²åˆ›å»º

**æ–‡ä»¶**: `export_test_data.py`

**åŠŸèƒ½**:
- ä» SignalPlus Trade Alert ç¾¤ç»„æ‹‰å–å†å²æ¶ˆæ¯
- ä½¿ç”¨ Asia/Shanghai æ—¶åŒº
- è‡ªåŠ¨è¿‡æ»¤ç©ºæ¶ˆæ¯
- ä¿å­˜ä¸ºç®€åŒ–çš„ JSON æ ¼å¼

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### å‘½ä»¤è¡Œæ‰§è¡Œï¼ˆ3ç§æ–¹å¼ï¼‰

```bash
# æ–¹å¼1: å¯¼å‡ºæœ€è¿‘30å¤©ï¼ˆé»˜è®¤ï¼‰
python3 export_test_data.py

# æ–¹å¼2: è‡ªå®šä¹‰å¤©æ•°ï¼ˆä¾‹å¦‚7å¤©ï¼‰
python3 export_test_data.py 7

# æ–¹å¼3: ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate
python export_test_data.py
```

### æ‰§è¡Œå‰ç½®æ¡ä»¶

âœ… å·²å®Œæˆ Telegram è®¤è¯ï¼ˆtelegram_session.session æ–‡ä»¶å­˜åœ¨ï¼‰
âœ… è™šæ‹Ÿç¯å¢ƒå·²å®‰è£…ä¾èµ–ï¼ˆtelethon, pytz ç­‰ï¼‰
âœ… config.py ä¸­æ‰‹æœºå·å·²é…ç½®

## ğŸ“Š JSON æ•°æ®æ ¼å¼ç¤ºä¾‹

```json
[
  {
    "message_id": 123456,
    "date": "2025-12-10 12:30:00",
    "text": "ğŸ·ï¸ Spot Prices\nBTC: $45,123.45\nETH: $2,345.67"
  },
  {
    "message_id": 123457,
    "date": "2025-12-10 13:00:00",
    "text": "#block BTC Call Option\nStrategy: Long Call\nNotional: $5.2M"
  }
]
```

### æ•°æ®ç‰¹ç‚¹

- âœ… ç®€åŒ–ç»“æ„ï¼ˆåªä¿ç•™ message_id, date, textï¼‰
- âœ… ä¸œå…«åŒºæ—¶é—´æ ¼å¼ï¼ˆYYYY-MM-DD HH:MM:SSï¼‰
- âœ… å·²è¿‡æ»¤ç©ºæ¶ˆæ¯å’Œçº¯åª’ä½“æ¶ˆæ¯
- âœ… æŒ‰æ—¶é—´æ­£åºæ’åºï¼ˆä»æ—§åˆ°æ–°ï¼‰

## ğŸ“‹ å·¥ä½œæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è¿è¡Œ export_test_data.py            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. æ‹‰å– Telegram ç¾¤ç»„æ¶ˆæ¯              â”‚
â”‚     â€¢ ä½¿ç”¨ç°æœ‰ session è®¤è¯             â”‚
â”‚     â€¢ æœ€è¿‘ 30 å¤©æ•°æ®                    â”‚
â”‚     â€¢ è‡ªåŠ¨è¿‡æ»¤ç©ºæ¶ˆæ¯                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ä¿å­˜ä¸º JSON                         â”‚
â”‚     tests/raw_messages/                 â”‚
â”‚     messages_last_30_days.json          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. åŸºäº JSON å¼€å‘æ¨¡æ¿                  â”‚
â”‚     â€¢ æ—¥æŠ¥æ ¼å¼è®¾è®¡                      â”‚
â”‚     â€¢ é¢„è­¦æç¤ºè®¾è®¡                      â”‚
â”‚     â€¢ æ•°æ®è§£æé€»è¾‘                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

å®Œæˆæ•°æ®å¯¼å‡ºåï¼Œå¯ä»¥è¿›è¡Œï¼š

### Phase III - ä»»åŠ¡ 1: æ—¥æŠ¥æ ¼å¼è®¾è®¡
- [ ] åˆ†æ JSON æ•°æ®ä¸­çš„æ¶ˆæ¯ç±»å‹
- [ ] è®¾è®¡æ—¥æŠ¥ HTML æ¨¡æ¿
- [ ] å®ç°æ•°æ®æå–å‡½æ•°ï¼ˆspot prices, block tradesï¼‰
- [ ] ç”Ÿæˆé¢„è§ˆæ–‡ä»¶åˆ° tests/reports_preview/

### Phase III - ä»»åŠ¡ 2: é¢„è­¦æç¤ºè®¾è®¡
- [ ] åˆ†æ #block æ ‡ç­¾æ¶ˆæ¯æ ¼å¼
- [ ] è®¾è®¡å®æ—¶é¢„è­¦æ¨¡æ¿
- [ ] å®ç°æ¶ˆæ¯è§£æå‡½æ•°
- [ ] ç”Ÿæˆé¢„è§ˆæ–‡ä»¶åˆ° tests/alerts_preview/

### Phase III - ä»»åŠ¡ 3: æ¶ˆæ¯è§£æå®ç°
- [ ] å®ç° parse_block_trade_message()
- [ ] å®ç° extract_spot_prices()
- [ ] å®ç° extract_top_trades()

### Phase III - ä»»åŠ¡ 4: é‚®ä»¶å‘é€
- [ ] é…ç½® SMTP æœåŠ¡å™¨
- [ ] å®ç° send_alert_email()
- [ ] å®ç° send_daily_report_email()

## ğŸ“ æ³¨æ„äº‹é¡¹

### âš ï¸ å½“å‰é˜¶æ®µçš„é™åˆ¶

1. **åªåšæ•°æ®å‡†å¤‡**
   - å½“å‰è„šæœ¬åªæ‹‰å–å’Œä¿å­˜åŸå§‹æ¶ˆæ¯
   - ä¸åšä»»ä½•è§£æå’Œåˆ†æ
   - Phase III å†å®ç°è§£æé€»è¾‘

2. **ä¸å½±å“æ­£å¼æ•°æ®**
   - æµ‹è¯•æ•°æ®ä¿å­˜åœ¨ç‹¬ç«‹çš„ tests/ ç›®å½•
   - ä¸å†™å…¥ data/reports.db æ•°æ®åº“
   - ä¸ä¸»ç¨‹åºå®Œå…¨éš”ç¦»

3. **æ‰‹åŠ¨è§¦å‘**
   - éœ€è¦æ‰‹åŠ¨è¿è¡Œè„šæœ¬
   - ä¸å½±å“å®šæ—¶ä»»åŠ¡
   - å¯ä»¥å¤šæ¬¡æ‰§è¡Œï¼ˆä¼šè¦†ç›–æ—§æ–‡ä»¶ï¼‰

## ğŸ” éªŒè¯æ•°æ®å¯¼å‡º

### æŸ¥çœ‹ JSON æ–‡ä»¶

```bash
# æ–¹å¼1: ç›´æ¥æŸ¥çœ‹ï¼ˆå‰10è¡Œï¼‰
head -n 10 tests/raw_messages/messages_last_30_days.json

# æ–¹å¼2: ä½¿ç”¨ jq ç¾åŒ–è¾“å‡ºï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
cat tests/raw_messages/messages_last_30_days.json | jq '.[0:3]'

# æ–¹å¼3: ç»Ÿè®¡æ¶ˆæ¯æ•°é‡
cat tests/raw_messages/messages_last_30_days.json | jq 'length'

# æ–¹å¼4: æŸ¥æ‰¾åŒ…å« #block çš„æ¶ˆæ¯
grep -i "#block" tests/raw_messages/messages_last_30_days.json
```

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: å¦‚æœè¿˜æ²¡æœ‰ session æ–‡ä»¶æ€ä¹ˆåŠï¼Ÿ
```bash
python3 telegram_client.py  # å…ˆå®Œæˆè®¤è¯
```

### Q2: å¦‚ä½•ä¿®æ”¹å¯¼å‡ºå¤©æ•°ï¼Ÿ
```bash
python3 export_test_data.py 7   # æ”¹ä¸º7å¤©
python3 export_test_data.py 90  # æ”¹ä¸º90å¤©
```

### Q3: å¯¼å‡ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ
æ£€æŸ¥ï¼š
1. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
2. session æ–‡ä»¶æ˜¯å¦è¿‡æœŸ
3. ç¾¤ç»„ ID æ˜¯å¦æ­£ç¡®ï¼ˆ-1001881744197ï¼‰

### Q4: å¯ä»¥é‡å¤å¯¼å‡ºå—ï¼Ÿ
å¯ä»¥ï¼Œè„šæœ¬ä¼šè¦†ç›–æ—§æ–‡ä»¶ï¼Œä¸ä¼šé‡å¤

## ğŸ“š ç›¸å…³æ–‡æ¡£

- è¯¦ç»†ä½¿ç”¨è¯´æ˜: `tests/README_TEST.md`
- é¡¹ç›®æ€»æ–‡æ¡£: `README.md`
- å¿«é€Ÿå¯åŠ¨: `QUICKSTART.md`
- é¡¹ç›®æ¦‚è§ˆ: `PROJECT_OVERVIEW.md`

---

**åˆ›å»ºæ—¥æœŸ**: 2025-12-11
**çŠ¶æ€**: âœ… æµ‹è¯•ç¯å¢ƒé…ç½®å®Œæˆ
**ä¸‹ä¸€æ­¥**: è¿è¡Œ export_test_data.py å¯¼å‡ºæ•°æ®
